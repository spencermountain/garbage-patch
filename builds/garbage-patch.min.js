!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).simpleJsonPatch={})}(this,(function(e){"use strict";const t=/^[0-9]+$/;var r=function(e){let r=e.split("/");for(let e=1;e<r.length;e+=1)r[e]=r[e].replace(/~1/g,"/").replace(/~0/g,"~"),t.test(r[e])&&(r[e]=parseInt(r[e],10));return r.length>1&&""===r[r.length-1]&&r.pop(),r};const p=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=function(e){return"number"==typeof e&&isFinite(e)},o=function(e){return"[object Object]"===Object.prototype.toString.call(e)};var a=function(e,t){if(!e)return t;let p=e;"string"==typeof e&&(p=r(e)),""===p[0]&&p.shift();let n=t;for(let e=0;e<p.length;e+=1){let t=p[e];if("-"===t)n=n[n.length-1];else if("number"==typeof t)n=n[t];else{if(!n.hasOwnProperty(t))return;n=n[t]}}return n};var l=function(e){return e&&0!==e.length?"/"+(e=e.map((e=>(e=String(e),e.replace(/~[^01]/g,"~0").replace(/\//g,"~1"))))).join("/"):""};var i=function(e,t){let n="",l=r(e);l.length>1&&(n=l.pop());let i=a(l,t);return p(i)||o(i)||(i=void 0),{parent:i,prop:n}};var u=(e,t)=>{let r=a(e.path,t);if(!0===p(r))return void r.push(e.value);if(!0===o(r)&&!0===o(e.value))return void Object.assign(r,e.value);let l=i(e.path,t);p(l.parent)&&("-"===l.prop?l.parent.push(e.value):n(l.prop)&&l.parent.splice(l.prop,0,e.value)),o(l.parent)&&"string"==typeof l.prop&&(l.parent[l.prop]=e.value)};var f=(e,t)=>{let r=i(e.path,t);o(r.parent)&&delete r.parent[r.prop],p(r.parent)&&n(r.prop)&&r.parent.splice(r.prop,1)};var c=(e,t)=>{let r=a(e.from,t),p={op:"remove",path:e.from};f(p,t);let n={op:"add",path:e.path,value:r};u(n,t)};var s=(e,t)=>{let r=a(e.from,t),p={op:"add",path:e.path,value:r};u(p,t)};const h={add:u,remove:f,replace:(e,t)=>{let r=i(e.path,t);o(r.parent)&&(r.parent[r.prop]=e.value),p(r.parent)&&n(r.prop)&&(r.parent[r.prop]=e.value)},move:c,copy:s,test:(e,t)=>{let r=a(e.path,t);if(JSON.stringify(r)!==JSON.stringify(e.value))throw new Error("garbage-patch error: patch-test failed '".concat(e.path,"'"))}};var v=function(e,t){return p(e)||(e=[e]),e.forEach((e=>{h[e.op]&&h[e.op](e,t)})),t};e.apply=v,e.get=a,e.getParent=i,e.make=l,Object.defineProperty(e,"__esModule",{value:!0})}));

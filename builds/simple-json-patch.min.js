!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).simpleJsonPatch=t()}(this,(function(){"use strict";const e=/^[0-9]+$/;var t=function(t){let r=t.split("/");for(let t=1;t<r.length;t+=1)r[t]=r[t].replace(/~1/g,"/").replace(/~0/g,"~"),e.test(r[t])&&(r[t]=parseInt(r[t],10));return r.length>1&&""===r[r.length-1]&&r.pop(),r};const r=t;var p=function(e,t){if(!e)return t;let p=e;if("string"==typeof e&&(p=r(e)),""!==p[0])return;let n=t;for(let e=1;e<p.length;e+=1){let t=p[e];if("-"===t)n=n[n.length-1];else if("number"==typeof t)n=n[t];else{if(!n.hasOwnProperty(t))return;n=n[t]}}return n};var n=function(e){return e&&0!==e.length?"/"+(e=e.map((e=>(e=String(e),e.replace(/~[^01]/g,"~0").replace(/\//g,"~1"))))).join("/"):""},o={isArray:e=>"[object Array]"===Object.prototype.toString.call(e),isBoolean:e=>"boolean"==typeof e,isNumber:e=>"number"==typeof e&&isFinite(e),isString:e=>"string"==typeof e,isObject:e=>"[object Object]"===Object.prototype.toString.call(e)};const a=t,i=p,{isArray:l,isObject:s}=o;var c=function(e,t){let r="",p=a(e);p.length>1&&(r=p.pop());let n=i(p,t);return l(n)||s(n)||(n=void 0),{parent:n,prop:r}};const u=p,f=c,{isArray:h,isNumber:v,isObject:g,isString:y}=o;var b=(e,t)=>{let r=u(e.path,t);if(!0===h(r))return void r.push(e.value);if(!0===g(r)&&!0===g(e.value))return void Object.assign(r,e.value);let p=f(e.path,t);h(p.parent)&&("-"===p.prop?p.parent.push(e.value):v(p.prop)&&p.parent.splice(p.prop,0,e.value)),g(p.parent)&&y(p.prop)&&(p.parent[p.prop]=e.value)};const d=c,{isArray:m,isNumber:j,isObject:O}=o;var A=(e,t)=>{let r=d(e.path,t);O(r.parent)&&delete r.parent[r.prop],m(r.parent)&&j(r.prop)&&r.parent.splice(r.prop,1)};const S=c,{isArray:N,isNumber:w,isObject:J}=o;var P=(e,t)=>{let r=S(e.path,t);J(r.parent)&&(r.parent[r.prop]=e.value),N(r.parent)&&w(r.prop)&&(r.parent[r.prop]=e.value)};const x=p,E=A,T=b;var $=(e,t)=>{let r=x(e.from,t),p={op:"remove",path:e.from};E(p,t);let n={op:"add",path:e.path,value:r};T(n,t)};const k=p,B=b;var F=(e,t)=>{let r=k(e.from,t),p={op:"add",path:e.path,value:r};B(p,t)};const I=p;var q=(e,t)=>{let r=I(e.path,t);if(JSON.stringify(r)!==JSON.stringify(e.value))throw new Error(`simple-json-patch error: patch-test failed '${e.path}'`)};const{isArray:z}=o,C={add:b,remove:A,replace:P,move:$,copy:F,test:q};return{get:p,make:n,apply:function(e,t){return z(e)||(e=[e]),e.forEach((e=>{C[e.op]&&C[e.op](e,t)})),t},getParent:c}}));
